USE Source 
Go

-- COPYING REQUIRED COLUMS FROM FILE TABLE TO FEATURE TABLE ----
SELECT [FILE_ID],[SHA1],[FAMILY],[SIZE],[FILETYPE]
INTO [Source].[dbo].[Feature]
FROM [Source].[dbo].[FILES]


SELECT *
FROM [Source].[dbo].[Feature]

-- 11668 ROWS----


-- Removing records where family is NULL ---

DELETE 
FROM [Source].[dbo].[Feature]
WHERE FAMILY IS NULL

-- 1759 RECORDS DELETED--

-- FINAL QUERY ---


USE Source 
Go

SELECT DISTINCT [FAMILY], COUNT([FAMILY]) AS NO
FROM [Source].[dbo].[Feature]
GROUP BY [FAMILY]
ORDER BY [FAMILY]

-- 53 DIFFERENT FAMILIES ---
-----------------------------------------------------------------------------------------------------------------
USE Source 
Go

SELECT DISTINCT [FAMILY], COUNT([FAMILY]) AS NO
FROM [Source].[dbo].[Feature]
GROUP BY [FAMILY]
ORDER BY COUNT([FAMILY]) DESC

-- Primary family---

-- winwebsec 5820 ---
-- zbot 2168 ---
-- zeroaccess 1306 ---
-- securityshield 150 --

-- Total Records --

SELECT *
FROM [Source].[dbo].[Feature]

--- 9909 RECORDS ----