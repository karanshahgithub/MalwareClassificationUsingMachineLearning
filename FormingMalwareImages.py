import pandas as pd
import numpy as numpy
import os
import array
import imageio
#Read a CSV file
p = pd.read_csv("Dataset/finaldataset/securityshield.csv") #repeat this for zeroaccess,zbot and winwebsec
#print(p.head())


#Storing 'SHA1' COLUMN IN X and FILETYPE COLUMN IN Y

X = p['SHA1']
Y = p['FILETYPE']
F = X+'.'+Y

#Looping over each exe file.
count = 0
for j in F:
            #Reading malware executble file.
            #Have given static file path. Update as per your path
            #plotting grayscale image after reading file
            try:
                f = open("/Volumes/ESD-USB/binaries_RELEASE1.0/"+j,'rb');
                filename = "/Volumes/ESD-USB/binaries_RELEASE1.0/"+j
                ln = os.path.getsize(filename);
                width = 256;
                rem = ln%width;
                a = array.array("B");
                a.fromfile(f,ln-rem);
                f.close();
                g = numpy.reshape(a,((int)(len(a)/width),width));
                g = numpy.uint8(g);
                imageio.imwrite("images/securityshield_images/"+j+".png",g)
            except:
                count=count+1
                print(count)
                print("file not found"+j)
                
                
